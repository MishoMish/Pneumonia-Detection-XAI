

**Софийски университет „Св. Кл. Охридски”**

Факултет по математика и информатика 

**Курсов Проект**

на тема:   
**„Интелигентна система за откриване на пневмония и визуализация на патологии чрез трансферно обучение”**

Студент: **Богомил Бойков Стоянов** Ф.Н. **8MI0800196**

Студент: **Михаил Бойков Доброславски** Ф.Н.  **8MI0800216**

Курс: „Изкуствен интелект“, Учебна година: 2025/26

Преподавател: **проф. Иван Койчев**

**\===============================================**

**Декларация за липса плагиатство:**

Плагиатство е да използваш, идеи, мнение или работа на друг, като претендираш, че са твои. Това е форма на преписване.

Тази курсова работа е моя, като всички изречения, илюстрации и програми от други хора са изрично цитирани.

Тази курсова работа или нейна версия не са представени в друг университет или друга учебна институция.

Разбирам, че ако се установи плагиатство в работата ми ще получа оценка “Слаб”.

**Подпис на студента: ..................................**

					    **(Богомил)**

**Подпис на студента: ..................................**

					    **(Михаил)**

**Дата: 20.01.2026г.** 

**\===============================================**

**Съдържание:**

1. **Увод**  
2. **Преглед на областта: Методи за образна диагностика с изкуствен интелект**  
3. **Проектиране на системата**  
4. **Реализация и експерименти**  
5. **Заключение**  
6. **Използвана литература**

## **1\. Увод**

### **Мотивация**

Пневмонията остава водеща причина за смъртност сред децата в световен мащаб. Диагностицирането ѝ разчита основно на рентгенови снимки на гръдния кош, чието разчитане изисква висококвалифицирани рентгенолози. Специалистите често са претоварени, което води до умора и повишен риск от лекарска грешка.

### **Цел и задачи**

Основната цел на проекта е създаването на система за компютърно подпомагана диагностика (Computer-Aided Diagnosis \- CAD), която да служи като „второ мнение“ за лекарите. За постигането на тази цел са дефинирани следните задачи:

1. Разработване на модел за автоматична бинарна класификация (Болен/Здрав) на базата на рентгенови изображения.  
2. Интегриране на Обясним Изкуствен Интелект (Explainable AI \- XAI) чрез генериране на топлинни карти (Heatmaps), които визуализират зоните на патология, за да се изгради доверие в решението на алгоритъма.  
3. Минимизиране на риска от пропускане на болни пациенти чрез постигане на висока чувствителност (Recall) на модела.

## 

## **2\. Преглед на областта: Методи за образна диагностика с изкуствен интелект**

### **Подходи и методи**

В областта на медицинския анализ на изображения съществуват няколко основни подхода:

* **Класически Machine Learning:** Разчита на ръчно извличане на характеристики (Feature Extraction) и класификатори като SVM или Random Forest. Недостатъкът е трудното дефиниране на визуални характеристики за болести.  
* **Конволюционни мрежи (CNN) от нулата:** Изискват огромен набор от данни и значителен изчислителен ресурс, което често е неприложимо при ограничени медицински набори от данни.  
* **Трансферно обучение (Transfer Learning):** Използване на предварително обучени модели (напр. върху ImageNet) като VGG16 или ResNet. Този метод позволява висока точност с по-малко данни и по-бърза конвергенция, поради което е избран за настоящия проект.

### **Съществуващи решения и сравнителен анализ**

Индустрията вече предлага решения от компании като Siemens Healthineers и Qure.ai, а в академичните среди водещ е моделът CheXNet на Станфорд. **Проблем:** Повечето комерсиални решения функционират като „черна кутия“ (Black Box) и са финансово недостъпни. 

**Предлагано решение:** Разработената система е с отворен код и се фокусира върху обяснимостта (XAI) чрез алгоритъма Grad-CAM, правейки технологията прозрачна и разбираема за медицинските специалисти.

## 

## **3\. Проектиране на системата**

### **Анализ на изискванията и Данни**

Системата използва набор от данни (Dataset), съдържащ 5,863 рентгенови изображения на гръден кош, разделени в две категории: Нормални (Normal) и Пневмония (Pneumonia). Основните предизвикателства са неструктурираните данни и дисбалансът на класовете (повече примери с пневмония), което налага използването на техники за балансиране.

### **Архитектура на модела**

Използвана е архитектура, базирана на **VGG16**, предварително тренирана върху ImageNet, модифицирана за конкретната задача:

1. **Base Model (Feature Extractor):** Конволюционните слоеве на VGG16 са „замразени“ (frozen), за да се използват вече научените характеристики (ръбове, текстури).  
2. **Classifier Head (Персонализиран класификатор):**  
   * *Global Average Pooling:* За намаляване на размерността и броя параметри.  
   * *Dense Layer:* 256 неврона с ReLU активация.  
   * *Dropout (0.5):* Регуляризация за предотвратяване на преобучаване (overfitting).  
   * *Output Layer:* 1 неврон със Sigmoid активация за бинарна прогноза (0-1).

### **Схема за представяне на знанията (XAI)**

За обяснимост на решенията е проектиран модул, използващ **Grad-CAM** (Gradient-weighted Class Activation Mapping).

* **Локация:** Използва се последният конволюционен слой, който пази пространствена информация.  
* **Важност:** Изчисляват се градиентите на целевия клас спрямо всяка карта на характеристиките, за да се определи кои пиксели влияят най-силно на решението.

## 

## **4\. Реализация и експерименти**

### **Използвани технологии**

Проектът е реализиран на езика **Python**, като са използвани следните библиотеки:

* **TensorFlow/Keras:** За изграждане и обучение на невронната мрежа.  
* **NumPy & Matplotlib:** За обработка на масиви и визуализация на данни.  
* **OpenCV:** За обработка на изображения.

### **Реализация на процеса (Pipeline)**

1. **Подготовка на данните (Pre-processing):** Всички изображения се преоразмеряват до 224x224 пиксела (вход за VGG16) и се нормализират в интервала \[0, 1\].  
2. **Обогатяване на данните (Data Augmentation):** За справяне с малкия набор данни са приложени случайни ротации (Random Rotation), мащабиране (Zoom) и промяна на контраста. Важно е да се отбележи, че хоризонталното обръщане (Random Flip) е изключено поради анатомичната позиция на сърцето.  
3. **Справяне с дисбаланса (Class Weights):** Вместо изтриване на данни е приложена стратегия с тегла на класовете, където грешките при клас "Нормален" (малцинството) се наказват по-строго.

### **Резултати от експериментите**

Основната метрика за оценка на медицински диагностичен модел е **Recall (Чувствителност)**, тъй като цената на фалшиво отрицателен резултат (пропуснат болен) е много висока.

Постигнати резултати:

* **Recall (Sensitivity): 99.74%** – Успешно постигната цел (\>95%).  
* **F1-Score:** 90.25%.  
* **AUC (Area Under Curve):** 0.9726.

Анализът на резултатите показва, че моделът е силно оптимизиран да открива пневмония, като понякога класифицира здрави пациенти като рискови (по-ниска специфика), което е приемлив компромис за скринингов инструмент.

### **Визуализация (XAI)**

Въпреки високите количествени показатели, качественият анализ чрез **Grad-CAM** разкрива, че в определени случаи моделът активира зони извън белодробния паренхим (например части от раменния пояс или диафрагмата). Това предполага, че класификаторът може да използва нерелевантни визуални артефакти за формиране на своите прогнози, което е индикация за необходимост от по-строго дефиниране на региона на интерес (Region of Interest \- ROI).

Пълният изходен код на проекта, заедно с инструкции за инсталация и конфигурация на средата, е достъпен в публично хранилище в GitHub на следния адрес: [**https://github.com/MishoMish/Pneumonia-Detection-XAI**](https://github.com/MishoMish/Pneumonia-Detection-XAI)

## **5\. Заключение**

В рамките на курсовия проект беше успешно реализиран пълен процес от обработка на сурови рентгенови данни до работещ модел за дълбоко обучение. **Основни постижения:**

* Постигната е медицинска надеждност с Recall от 99.74%.  
* Решен е проблемът с „черната кутия“ чрез интеграция на Grad-CAM за визуална обосновка.  
* Оптимизираната архитектура с Global Average Pooling доказа ефективност при дисбалансирани данни.

**Бъдещо развитие:** Като ключова насока за бъдещо усъвършенстване на системата се очертава интегрирането на предварителен етап за автоматична сегментация на белите дробове (например чрез архитектура U-Net). Настоящият анализ чрез Grad-CAM показва, че моделът понякога активира зони извън белодробния паренхим, което е индикация за наличие на статистически шум или „предубеденост“ (bias) на класификатора. Чрез внедряване на алгоритъм, който автоматично изрязва и изолира единствено региона на интерес (Region of Interest \- ROI), моделът ще бъде принуден да фокусира своите изчисления изцяло върху анатомичните структури, където се проявяват патологиите. Това ще повиши прецизността на класификацията и ще подобри клиничната достоверност на генерираните топлинни карти, осигурявайки по-високо ниво на доверие от страна на медицинските специалисти.

**6\. Използвана литература**

1. Kermany, Daniel S., et al. "Identifying medical diagnoses and treatable diseases by image-based deep learning." *Cell* 172.5 (2018): 1122-1131.  
2. Simonyan, Karen, and Andrew Zisserman. "Very deep convolutional networks for large-scale image recognition." *International Conference on Learning Representations (ICLR)*. 2015\.  
3. Selvaraju, Ramprasaath R., et al. "Grad-CAM: Visual explanations from deep networks via gradient-based localization." *Proceedings of the IEEE International Conference on Computer Vision (ICCV)*. 2017\.  
4. Pan, Sinno Jialin, and Qiang Yang. "A survey on transfer learning." *IEEE Transactions on Knowledge and Data Engineering* 22.10 (2010): 1345-1359.  
5. Abadi, Martín, et al. "TensorFlow: A system for large-scale machine learning." *12th USENIX Symposium on Operating Systems Design and Implementation (OSDI 16\)*. 2016\.

